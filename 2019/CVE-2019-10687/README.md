# CVE-2019-10687: Multiple SQL Injection in KBPublisher
## Software
[![](https://img.shields.io/badge/Attack%20Vector-Remote-red?style=flat-square)]() [![](https://img.shields.io/badge/Privileges%20Required-None-red?style=flat-square)]() [![](https://img.shields.io/badge/User%20Interaction-No-red?style=flat-square)]()

__Vendor:__ KBPublisher<br>
__Vendor URL:__ https://www.kbpublisher.com<br>
__Versions affected:__ KBPublisher 6.0.2.1<br>
__Discovered by:__ Pedro Andujar ([@pandujar](https://twitter.com/pandujar))<br>
__Public fix:__ Yes<br>
__Proof of Concept:__ No<br>


## Summary
KBPublisher release 6.0.2, and probably prior versions, contain multiple SQLi vulnerabilities that affect not only the admin interface but also the public (unauthenticated)
area of the application.

## Details

Affected URL's from the admin area (also affecting to POST parameters):

```
https://SITE/admin/index.php?module=report&page=report_entry&entry_id%5B0%5D=325PAYLOAD&filter%5Bt%5D=1&ajax=1 
```

```
https://SITE/admin/index.php?module=log&page=login_log&action=detail&id=PAYLOAD
```

The publicly accesible URL, correspond to the print feature:

```
https://SITE/index.php?View=print&id%5B%5D=PAYLOAD
```

## Impact
This vulnerability can be abused to extract users and password hashes from the database. 

## Recommendation
Upgrade to version 7.0 or higher.

## Timeline
* 21/Mar/2019:   - Vuln discovered during engagement.
* 21/Mar/2019:   - KBP product security contacted. 
* 22/Mar/2019:   - Replied providing workarround. 
* 30/Apr/2019:   - New release of KBP released to public. 
* 21/Ago/2019:   - Public disclosure.

#

[![](https://img.shields.io/badge/www-blackarrow.net-E5A505?style=flat-square)](https://www.blackarrow.net) [![](https://img.shields.io/badge/twitter-@BlackArrowSec-00aced?style=flat-square&logo=twitter&logoColor=white)](https://twitter.com/BlackArrowSec) [![](https://img.shields.io/badge/linkedin-@BlackArrowSec-0084b4?style=flat-square&logo=linkedin&logoColor=white)](https://www.linkedin.com/company/blackarrowsec/)
